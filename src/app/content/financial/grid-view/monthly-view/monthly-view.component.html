<mat-progress-bar *ngIf="!gridReady" mode="indeterminate" color="accent"></mat-progress-bar>

<!-- navegação calendário -->
<div class="mhq-row mhq-monthly-grid-nav">

  <button mat-icon-button color="primary" [matMenuTriggerFor]="changeViewMenu">
    <mat-icon>visibility</mat-icon>
  </button>

  <button mat-icon-button color="primary" (click)="changeMonth(-1)">
    <mat-icon>arrow_back_ios_new</mat-icon>
  </button>

  <span id="mhq-grid-subtitle">{{gridSubtitle}}</span>

  <button mat-icon-button color="primary" (click)="changeMonth(1)">
    <mat-icon>arrow_forward_ios_new</mat-icon>
  </button>

  <input matInput [matDatepicker]="picker" style="width: 0px;height: 0px;opacity: 0;">
  <mat-datepicker #picker startView="multi-year" (monthSelected)="monthPicked($event, picker)">
    <mat-datepicker-actions>
      <button mat-raised-button color="primary" (click)="changeMonth(0,picker)">Hoje</button>
    </mat-datepicker-actions>
  </mat-datepicker>

  <button mat-icon-button color="primary" (click)="picker.open()">
    <mat-icon>today</mat-icon>
  </button>

  <mat-menu #changeViewMenu="matMenu">
    <button mat-menu-item disabled>
      <mat-icon>calendar_month</mat-icon>
      <span>Vista mensal</span>
    </button>
    <button mat-menu-item disabled>
      <mat-icon>calendar_month</mat-icon>
      <span>Vista anual</span>
    </button>
    <button mat-menu-item disabled>
      <mat-icon>calendar_month</mat-icon>
      <span>Vista década</span>
    </button>
  </mat-menu>

</div>

<!-- calendário -->
<div class="mhq-row">
  <div class="mhq-col-2" style="height: 30px;margin-right: 10px;"></div>
  <div class="mhq-col-10">
    <!-- loop para cabeçalho com o calendario -->
    <div class="mhq-row">
      <div *ngFor="let x of placeholder; let i = index;"
        style="width:100%;height:30px;color:coral;display: flex;align-items: center;justify-content: center;font-weight: 600;font-size:18px;">
        {{i+1}}</div>
    </div>
  </div>
</div>

<!-- grelha (para envolver em scroll bar quando necessário) -->
<div *ngIf="gridReady" id="mhq-grid-wrapper" class="mhq-row">

  <!-- títulos de categorias -->
  <div id="mhq-grid-categories-wrapper" class="mhq-col-2" style="margin-right: 10px;">
    <mat-spinner *ngIf="!areCategoriesReady" color="accent" style="margin:auto"></mat-spinner>

    <div *ngIf="areCategoriesReady">

      <!-- loop para categorias  -->
      <div *ngFor="let cat of activeCategories" class="mhq-grid-active-category">
        <div class="mhq-grid-category-title" [style]="miscService.getCategoryStyles(cat.id)">
          <mat-icon>{{cat.icon}}</mat-icon>{{cat.title}}
        </div>

        <!-- loop para sub categorias  -->
        <div *ngFor="let subcat of cat.subcats" class="mhq-grid-active-subcategory">
          <div *ngIf="subcat.active" class="mhq-grid-subcategory-title" [style]="miscService.getCategoryStyles(cat.id)">
            {{subcat.title}}</div>
        </div>

      </div>

    </div>

  </div>

  <!--  celulas para valores do snapshot  -->
  <div id="mhq-grid-cells-wrapper" class="mhq-col-10">
    <mat-spinner *ngIf="!areCategoriesReady" color="accent" style="margin:auto"></mat-spinner>

    <div *ngIf="areCategoriesReady">

      <!-- loop para celuluas diárias  -->
      <div class="mhq-row" *ngFor="let cat of activeCategories" style="flex-wrap: wrap;"
        class="mhq-grid-active-category">

        <!-- celulas da categoria -->
        <div class="mhq-row">
          <div *ngFor="let x of placeholder; let i = index;" [ngStyle]="miscService.getCategoryStyles(cat.id)"
            class="mhq-category-summary" (click)="showDailyCatDetails(cat.id,i+1)">
            {{monthlySnapshots.categories[cat.id][i] === 0? '0' : monthlySnapshots.categories[cat.id][i] | number:'1.2-2'}}
          </div>
        </div>

        <!-- celulas da sub categoria -->
        <div class="mhq-row" *ngFor="let subcat of cat.subcats">
          <div *ngFor="let x of placeholder; let i = index;" style="width:100%;">
            <div *ngIf="subcat.active" class="mhq-active-subcat-cell" [ngStyle]="miscService.getCategoryStyles(cat.id)"
              [ngClass]="monthlySnapshots.subcategories[subcat.id][i]===0? 'mhq-null-cell':'mhq-not-null-cell'"
              (click)="showDailySubCatDetails(subcat.id,i+1)">
              <span>{{monthlySnapshots.subcategories[subcat.id][i] | number:'1.2-2'}}</span>

            </div>
          </div>
        </div>

      </div>

    </div>

  </div>

</div>